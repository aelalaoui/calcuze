<IfModule mod_rewrite.c>
    RewriteEngine On

    # Définir la base pour éviter les problèmes de chemin
    RewriteBase /calcuze/

    # ============================================
    # French language - all countries redirect to index.php
    # ============================================
    RewriteRule ^fr/(FR|BE|CH|CA|LU|MC)/?$ index.php?lang=fr&country=$1 [QSA,L]
    RewriteRule ^fr/?$ index.php?lang=fr&country=FR [QSA,L]

    # ============================================
    # English language - all countries redirect to index.php
    # ============================================
    RewriteRule ^en/(US|GB|AU|CA|NZ|IE)/?$ index.php?lang=en&country=$1 [QSA,L]
    RewriteRule ^en/?$ index.php?lang=en&country=US [QSA,L]

    # ============================================
    # Root - detect language from browser or default to English
    # ============================================
    RewriteCond %{REQUEST_URI} ^/?$
    RewriteRule ^/?$ index.php [QSA,L]

    # Redirect index.html to index.php
    RewriteCond %{THE_REQUEST} ^GET\ /calcuze/index\.html
    RewriteRule ^index\.html$ index.php [R=301,L]

    # Make index.php accessible without extension (optional)
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !\.php$
    RewriteRule ^([^\.]+)$ $1.php [NC,L]
</IfModule>